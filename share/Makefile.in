PREFIX	= $(bmake_PREFIX)
CFLAGS	= -O2 -Wall -Werror -I$(PREFIX)/include $(bmake_CFLAGS)
#LDFLAGS = -lerm -lclip -L$(PREFIX)/lib -Wl,-rpath=$(PREFIX)/lib $(bmake_LDFLAGS)
CC	= $(bmake_CC)
LD	= $(bmake_LD)
DEPDIRS = src/deps

all: 

sinclude src/deps/*

%.o: %.c Makefile
	@if [ ! -d "$(@D)/deps" ] ; then mkdir "$(@D)/deps" ; fi
	$(CC) $(CFLAGS) -MD -MP -MF $(@D)/deps/$(@F).dep -c $< -o $@

clean:
	rm -f src/*.o

maintainer-clean: clean
	$(bmake_clean)
	rm -rf $(DEPDIRS)

Makefile: Makefile.in configure
	@echo "rebuilding makefile"
	$(bmake_reconfigure)

Makefile.in:

configure: mktests/*
	@touch configure

.PHONY: all clean maintainer-clean dist
